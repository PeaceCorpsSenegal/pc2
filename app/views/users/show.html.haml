.container
  .row
    .span-5
      = render 'shared/menu'
    .span-15
      .box
        %h1
          = @user.name
          .tags.right.inline= render 'shared/tags', :tags => @user.tag_list
        .span-12
          -#%p= @user.country.name

          %h3 Connect
          %p
            = @user.email
            - unless @user.email2.nil?
              %br
              = @user.email2
          - unless @user.phone1.nil?
            %p
              = @user.phone1
              - unless @user.phone2.nil?
                %br
                = @user.phone2
        .span-12.last
          - if @user.blogs.any?
            %p #{link_to @user.blogs.first.title, @user.blogs.first.url} &rang; #{@user.blogs.first.description}
          - unless @user.site.nil?
            %p= link_to @user.site
          - if @user.contributions.any?
            %h3 Contributions
            %ul= render :partial => 'contributions/contribution', :collection => @user.contributions
          - if @user.libraries.any?
            %h3 Collections
            %ul= render @user.libraries
        .clearfloat
      - if @user.bio
        .box
          %h4 A little bit about #{@user.name}...
          = markdown(@user.bio)

      - @user.volunteers.each do |v|
        .box
          %h1= v.local_name
          %div
            %p
              = "#{v.sector.name} Volunteer" if v.sector
              %br
              -#= v.country.name if v.country
              %br
              = v.stage.name if v.stage
            %h4 Site
            %p= v.site.name if v.site
            - if v.emphasis
              %h4 Emphasis
              %p= v.emphasis
            - if v.projects
              %h4 Projects
              %p= v.projects

      - @user.staff.each do |s|
        .box
          %h3 Staff Member
          %h4= s.site.name
          %p
            = s.building
            = "| #{s.office}" if s.office
            = "| #{s.floor.to_i.ordinalize} floor" if s.floor
          -if s.morning_open
            %p
              = s.morning_open.to_formatted_s(format = :time)
              \-
              = s.morning_close.to_formatted_s(format = :time)
              %br
              = s.afternoon_open.to_formatted_s(format = :time)
              \-
              = s.afternoon_close.to_formatted_s(format = :time)
          = markdown(s.details) if s.details


      - if @user.photos.any?
        .box
          %h3 Recently Uploaded Photos
          - @user.photos.limit(5).each do |p|
            = render p
      .box
        %h3 Recently Uploaded Docs
        - @user.documents.limit(5).each do |d|
          %p.inline.center
            = image_tag('icons/disk.png', :width => 100, :height => 100)
            %br
            = link_to d.name, d
            %br
            = link_to icon(:file_download), d
      .box
        %h3 Recently Edited Pages
    .span-4.last
      = avatar_for_user @user, :size => :small
      = button_to 'Edit profile', edit_user_path, :method => :get if current_user?(@user)
      - if @user.avatar? && current_user?(@user)
        = button_to 'Remove photo', remove_avatar_user_path, :method => :put, :remote => true, :disable_with => 'please wait...'
      = button_to "I'm a Volunteer!", volunteer_request_feedback_index_path, :method => :get if current_user?(@user) && !@user.volunteers.any?
      - if signed_in? && (current_user?(@user) || current_user.admin?)
        - unless @user.groups.empty?
          %h3 Groups
          %ul
            = render @user.groups
        - if @user.authorizations.any?
          %h3 Social Connections
          %ul
            = render @user.authorizations
        - unless @user.permissions.empty?
          %h3 Specific Permissions
          %ul= render :partial => 'permissions/permission', :collection => @user.permissions
        - unless @user.groups.empty?
          %h3 Group Permissions
          - @user.groups.each do |g|
            %h4= g.name
            %ul= render :partial => 'permissions/permission', :collection => g.permissions
